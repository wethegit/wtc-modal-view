"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var Modal=function(){function Modal(){_classCallCheck(this,Modal),this.state=!1,this.modal=document.createElement("div"),this.modalOverlay=document.createElement("div"),this.modalFocusStart=document.createElement("div"),this.modalFocusEnd=document.createElement("div"),this.modalClose=document.createElement("button"),this.modalClose.innerHTML="<span>Close</span>",this.modalWrapper=document.createElement("div"),this.modalContent=document.createElement("div"),this.className="modal",this.classNameOpen="modal--open",this.appended=!1,this._onOpen=null,this._onClose=null,this._focusOnClose=null,this.modal.classList.add(this.className),this.modalOverlay.classList.add("".concat(this.className,"__overlay")),this.modalFocusStart.classList.add("".concat(this.className,"__focus-start")),this.modalFocusEnd.classList.add("".concat(this.className,"__focus-end")),this.modalClose.classList.add("".concat(this.className,"__close")),this.modalWrapper.classList.add("".concat(this.className,"__wrapper")),this.modalContent.classList.add("".concat(this.className,"__content")),this.modal.setAttribute("role","dialog"),this.modalFocusStart.setAttribute("tabindex",-1),this.modalFocusEnd.setAttribute("tabindex",0),this.modalWrapper.appendChild(this.modalFocusStart),this.modalWrapper.appendChild(this.modalClose),this.modalWrapper.appendChild(this.modalContent),this.modalWrapper.appendChild(this.modalFocusEnd),this.modal.appendChild(this.modalOverlay),this.modal.appendChild(this.modalWrapper),this.modalFocusEnd.addEventListener("focus",this.focusFirstElement.bind(this)),this.modalClose.addEventListener("click",this.close.bind(this)),this.modalOverlay.addEventListener("click",this.close.bind(this))}return _createClass(Modal,[{key:"close",value:function(){var _this=this;this.state&&(this.modal.classList.remove(this.classNameOpen),this.focusOnClose&&this.focusOnClose.focus(),setTimeout(function(){_this.state=!1},500),Modal.hash&&history.replaceState("",document.title,window.location.pathname),this.onClose&&this.onClose())}},{key:"open",value:function(){var _this2=this;if(!this.state){document.body.appendChild(this.modal);var delay=this.appended?0:100;this.appended||(this.appended=!0),setTimeout(function(){_this2.modal.classList.add(_this2.classNameOpen)},delay),this.state=!0,this.focusFirstElement(),this.onOpen&&this.onOpen();document.addEventListener("keydown",function onKeyDown(e){27==e.keyCode&&(_this2.close(),document.removeEventListener("keydown",onKeyDown.bind(_this2),!1))}.bind(this),!1)}}},{key:"focusFirstElement",value:function(){this.modalFocusStart.focus()}},{key:"focusOnClose",get:function(){return this._focusOnClose},set:function(element){!element instanceof HTMLButtonElement&&!element instanceof HTMLAnchorElement&&!element.getAttribute("tabindex")||(this._focusOnClose=element)}},{key:"onOpen",get:function(){return this._onOpen},set:function(callback){callback&&"function"==typeof callback&&(this._onOpen=callback)}},{key:"onClose",get:function(){return this._onClose},set:function(callback){callback&&"function"==typeof callback&&(this._onClose=callback)}},{key:"optionalClass",set:function(className){className&&"string"==typeof className&&(this.modal.classList.remove(this._optionalClass),this.modal.classList.add(className))}},{key:"closeButtonContent",set:function(content){content&&("string"!=typeof content?content instanceof HTMLElement&&this.modalClose.appendChild(content):this.modalClose.innerHTML=content)}},{key:"content",set:function(content){content&&("string"!=typeof content?content instanceof HTMLElement&&this.modalContent.appendChild(content):this.modalContent.innerHTML=content)}}],[{key:"hash",get:function(){var URLhash=/#\!?\/(.+)\//i.exec(window.location.hash);return URLhash&&1<URLhash.length?URLhash[1]:null}}]),Modal}(),_default=Modal;exports.default=_default;